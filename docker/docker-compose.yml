# LLDPq Docker Compose
# Usage: docker compose up -d
#
# All 3 config files (devices.yaml, topology.dot, topology_config.yaml) come with
# example data baked into the image. Override with volume mounts if needed.
#
# SSH keys persist in a named volume across container recreation.

services:
  lldpq:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    image: lldpq:latest
    container_name: lldpq
    ports:
      - "${LLDPQ_PORT:-80}:80"
    volumes:
      # Optional: Override baked-in example files with your own
      # - ./devices.yaml:/home/lldpq/lldpq/devices.yaml
      # - ./topology.dot:/var/www/html/topology.dot
      # - ./topology_config.yaml:/var/www/html/topology_config.yaml

      # Optional: Ansible directory (enables VLAN/BGP reports, Fabric Config/Editor/Deploy)
      # - ~/ansible:/home/lldpq/ansible:rw

      # Persistent monitoring data (survives container restart/recreation)
      - lldpq-data:/home/lldpq/lldpq/monitor-results
      - lldpq-configs:/var/www/html/configs
      - lldpq-hstr:/var/www/html/hstr
    restart: unless-stopped
    environment:
      - TZ=${TZ:-UTC}
      # Uncomment if mounting Ansible directory:
      # - ANSIBLE_DIR=/home/lldpq/ansible

volumes:
  lldpq-data:      # Monitoring results
  lldpq-configs:   # Device configurations
  lldpq-hstr:      # Historical data
