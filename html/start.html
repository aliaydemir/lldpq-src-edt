<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>..::LLDPQ::..</title>
    <link rel="shortcut icon" href="/png/favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1e1e1e;
            color: #d4d4d4;
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Page Header */
        .page-header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid #404040;
            margin-bottom: 25px;
        }
        
        .main-title {
            font-size: 2.8em;
            font-weight: bold;
            color: #76b900;
            margin: 0 0 15px 0;
        }
        
        .nvidia-logo {
            margin: 15px 0;
        }
        
        .nvidia-logo img {
            max-width: 180px;
            border-radius: 8px;
            opacity: 0.9;
        }
        
        .last-updated {
            font-size: 13px;
            color: #888;
            margin-top: 10px;
        }
        
        /* Dashboard Overview Stats */
        .dashboard-stats {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid #404040;
        }
        
        .dashboard-stats-title {
            font-size: 13px;
            font-weight: 600;
            color: #76b900;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            background: #252526;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #76b900;
            text-align: center;
        }
        
        .stat-value {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Critical Issues Tooltip */
        .critical-tooltip {
            display: none;
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e1e1e;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 12px 15px;
            min-width: 220px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            margin-top: 8px;
            font-size: 12px;
            text-align: left;
        }
        
        .critical-tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #555;
        }
        
        #critical-issues-container:hover .critical-tooltip {
            display: block;
        }
        
        .tooltip-title {
            font-weight: 600;
            color: #76b900;
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid #404040;
        }
        
        .tooltip-row {
            display: flex;
            justify-content: space-between;
            padding: 3px 0;
            color: #d4d4d4;
        }
        
        .tooltip-row.has-issues {
            color: #f44336;
        }
        
        .tooltip-row .source {
            color: #888;
        }
        
        .tooltip-row .count {
            font-weight: 600;
        }
        
        /* Analysis Sections */
        .analysis-section {
            background: #2d2d2d;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .section-header {
            padding: 12px 16px;
            background: #333;
            border-bottom: 1px solid #404040;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #76b900;
            margin: 0;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s;
        }
        
        .section-title:hover {
            color: #8bd400;
        }
        
        .section-content {
            padding: 16px;
        }
        
        /* Summary Cards Grid */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }
        
        .summary-card {
            background: #252526;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #76b900;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .summary-card:hover {
            background: #2a2d2e;
            transform: translateY(-2px);
        }
        
        .card-value {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .card-label {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Card Border Colors */
        .card-total { border-left-color: #4fc3f7; }
        .card-excellent { border-left-color: #76b900; }
        .card-good { border-left-color: #8bc34a; }
        .card-warning { border-left-color: #ff9800; }
        .card-critical { border-left-color: #f44336; }
        .card-info { border-left-color: #4fc3f7; }
        
        /* Status Colors */
        .status-excellent { color: #76b900; }
        .status-good { color: #8bc34a; }
        .status-warning { color: #ffb74d; }
        .status-critical { color: #ff6b6b; }
        .status-info { color: #4fc3f7; }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #404040;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="main-title">LLDPQ</h1>
            <div class="nvidia-logo">
                <img src="/png/nvidia-logo.jpg" alt="NVIDIA Logo">
            </div>
            <div class="last-updated">
                Last Updated: <span id="last-updated-time"></span>
            </div>
        </div>
        
        <!-- Dashboard Overview Stats -->
        <div class="dashboard-stats">
            <div class="dashboard-stats-title">Network Health Overview</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="total-network-devices">--</div>
                    <div class="stat-label">Total Devices</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-interfaces">--</div>
                    <div class="stat-label">Total Interfaces</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="overall-health">--</div>
                    <div class="stat-label">Overall Health</div>
                </div>
                <div class="stat-item" id="critical-issues-container" style="position: relative; cursor: help;">
                    <div class="stat-value" id="critical-issues">--</div>
                    <div class="stat-label">Critical Issues</div>
                    <div class="critical-tooltip" id="critical-tooltip"></div>
                </div>
            </div>
        </div>

        <!-- Hardware Health Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M22 9V7h-2V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2h2v-2h-2v-2h2v-2h-2V9h2zM4 5h14v14H4V5zm8 12c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm0-8c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"/></svg>
                    Hardware Health Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <div class="card-value" id="hardware-total">--</div>
                    <div class="card-label">Total Devices</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <div class="card-value status-excellent" id="hardware-excellent">--</div>
                    <div class="card-label">Excellent</div>
                </div>
                <div class="summary-card card-good" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <div class="card-value status-good" id="hardware-good">--</div>
                    <div class="card-label">Good</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <div class="card-value status-warning" id="hardware-warnings">--</div>
                    <div class="card-label">Warnings</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='/monitor-results/hardware-analysis.html'">
                    <div class="card-value status-critical" id="hardware-critical">--</div>
                    <div class="card-label">Critical</div>
                </div>
            </div>
            </div>
        </div>

        <!-- Log Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm4 18H6V4h7v5h5v11zM8 12h8v2H8v-2zm0 4h8v2H8v-2z"/></svg>
                    Log Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <div class="card-value" id="log-devices">--</div>
                    <div class="card-label">Total Devices</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <div class="card-value status-critical" id="log-critical">--</div>
                    <div class="card-label">Critical</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <div class="card-value status-warning" id="log-warnings">--</div>
                    <div class="card-label">Warnings</div>
                </div>
                <div class="summary-card card-info" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <div class="card-value status-info" id="log-errors">--</div>
                    <div class="card-label">Errors</div>
                </div>
                <div class="summary-card card-good" onclick="window.location.href='/monitor-results/log-analysis.html'">
                    <div class="card-value status-good" id="log-info">--</div>
                    <div class="card-label">Info Messages</div>
                </div>
            </div>
            </div>
        </div>

        <!-- Assets Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='assets.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M4 1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1z"/></svg>
                    Asset Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='assets.html'">
                    <div class="card-value" id="assets-total">16</div>
                    <div class="card-label">Total Devices</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='assets.html'">
                    <div class="card-value status-excellent" id="assets-success">16</div>
                    <div class="card-label">Successful</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='assets.html'">
                    <div class="card-value status-critical" id="assets-failed">0</div>
                    <div class="card-label">Failed</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='assets.html'">
                    <div class="card-value status-warning" id="assets-warnings">0</div>
                    <div class="card-label">Warnings</div>
                </div>
                <div class="summary-card card-info" onclick="window.location.href='assets.html'">
                    <div class="card-value status-info" id="assets-no-info">0</div>
                    <div class="card-label">No Information</div>
                </div>
            </div>
            </div>
        </div>

        <!-- LLDP Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='lldp.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17 16l-4-4V8.82C14.16 8.4 15 7.3 15 6c0-1.66-1.34-3-3-3S9 4.34 9 6c0 1.3.84 2.4 2 2.82V12l-4 4H3v5h5v-3.05l4-4.2 4 4.2V21h5v-5h-4z"/></svg>
                    LLDP Topology Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='lldp.html'">
                    <div class="card-value" id="lldp-total">78</div>
                    <div class="card-label">Total Connections</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='lldp.html'">
                    <div class="card-value status-excellent" id="lldp-success">72</div>
                    <div class="card-label">Successful Links</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='lldp.html'">
                    <div class="card-value status-critical" id="lldp-failed">2</div>
                    <div class="card-label">Failed Links</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='lldp.html'">
                    <div class="card-value status-warning" id="lldp-warning">3</div>
                    <div class="card-label">Warning Links</div>
                </div>
                <div class="summary-card card-info" onclick="window.location.href='lldp.html'">
                    <div class="card-value status-info" id="lldp-no-info">1</div>
                    <div class="card-label">No Info Links</div>
                </div>
            </div>
            </div>
        </div>

        <!-- BGP Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                    BGP Neighbor Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <div class="card-value" id="bgp-devices">0</div>
                    <div class="card-label">BGP Devices</div>
                </div>
                <div class="summary-card card-info" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <div class="card-value" id="bgp-neighbors">0</div>
                    <div class="card-label">Total Neighbors</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <div class="card-value status-excellent" id="bgp-established">0</div>
                    <div class="card-label">Established</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <div class="card-value status-critical" id="bgp-down">0</div>
                    <div class="card-label">Down/Problem</div>
                </div>
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/bgp-analysis.html'">
                    <div class="card-value" id="bgp-health">0.0%</div>
                    <div class="card-label">Health Ratio</div>
                </div>
            </div>
            </div>
        </div>

        <!-- Link Flap Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/></svg>
                    Link Flap Detection
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <div class="card-value" id="flap-devices">1</div>
                    <div class="card-label">Total Devices</div>
                </div>
                <div class="summary-card card-info" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <div class="card-value" id="flap-ports">4</div>
                    <div class="card-label">Total Ports</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <div class="card-value status-excellent" id="flap-stable">4</div>
                    <div class="card-label">Stable</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <div class="card-value status-critical" id="flap-problematic">0</div>
                    <div class="card-label">Problematic</div>
                </div>
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/link-flap-analysis.html'">
                    <div class="card-value" id="flap-stability">100.0%</div>
                    <div class="card-label">Stability Ratio</div>
                </div>
            </div>
            </div>
        </div>

        <!-- Optical Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"/></svg>
                    Optical Diagnostics Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <div class="card-value" id="optical-total">944</div>
                    <div class="card-label">Total Ports</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <div class="card-value status-excellent" id="optical-excellent">725</div>
                    <div class="card-label">Excellent</div>
                </div>
                <div class="summary-card card-good" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <div class="card-value status-good" id="optical-good">32</div>
                    <div class="card-label">Good</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <div class="card-value status-warning" id="optical-warning">0</div>
                    <div class="card-label">Warning</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='monitor-results/optical-analysis.html'">
                    <div class="card-value status-critical" id="optical-critical">187</div>
                    <div class="card-label">Critical</div>
                </div>
            </div>
            </div>
        </div>

        <!-- BER Analysis Section -->
        <div class="analysis-section">
            <div class="section-header">
                <h2 class="section-title" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                    BER Analysis
                </h2>
            </div>
            <div class="section-content">
            <div class="summary-grid">
                <div class="summary-card card-total" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <div class="card-value" id="ber-total">0</div>
                    <div class="card-label">Total Ports</div>
                </div>
                <div class="summary-card card-excellent" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <div class="card-value status-excellent" id="ber-excellent">0</div>
                    <div class="card-label">Excellent</div>
                </div>
                <div class="summary-card card-good" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <div class="card-value status-good" id="ber-good">0</div>
                    <div class="card-label">Good</div>
                </div>
                <div class="summary-card card-warning" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <div class="card-value status-warning" id="ber-warning">0</div>
                    <div class="card-label">Warning</div>
                </div>
                <div class="summary-card card-critical" onclick="window.location.href='monitor-results/ber-analysis.html'">
                    <div class="card-value status-critical" id="ber-critical">0</div>
                    <div class="card-label">Critical</div>
                </div>
            </div>
            </div>
        </div>

    </div>

    <script>
        // Set last updated time
        function setLastUpdated() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            };
            const formattedDate = now.toLocaleString('en-US', options);
            document.getElementById('last-updated-time').textContent = formattedDate;
        }

        // Fetch summary data directly from data files
        async function fetchRawDataSummary(dataType) {
            try {
                let summaryData = {};
                
                if (dataType === 'assets') {
                    // Parse assets.ini file with same logic as assets.html
                    const assetsResponse = await fetch('assets.ini');
                    const assetsText = await assetsResponse.text();
                    const assetsLines = assetsText.split('\n').filter(line => 
                        line.trim() && 
                        !line.startsWith('DEVICE-NAME') && 
                        !line.startsWith('Created on')
                    );
                    
                    summaryData.totalDevices = assetsLines.length;
                    summaryData.successful = 0;
                    summaryData.failed = 0;
                    summaryData.warning = 0;
                    summaryData.noInfo = 0;
                    
                    // Parse each line using same logic as assets.html
                    assetsLines.forEach(line => {
                        if (!line.trim()) return;
                        
                        const parts = line.trim().split(/\s+/);
                        if (parts.length < 6) return;
                        
                        const deviceName = parts[0];
                        const ipAddress = parts[1];
                        const macAddress = parts[2];
                        const serialNumber = parts[3];
                        const model = parts[4];
                        const release = parts[5];
                        const uptime = parts.slice(6).join(' ');
                        
                        // Use exact same status determination logic as assets.html
                        const lineText = line.toLowerCase();
                        
                        if (lineText.includes('ssh-failed') || (ipAddress && ipAddress !== 'No-Info' && macAddress === 'SSH-FAILED')) {
                            summaryData.failed++;
                        } else if (lineText.includes('fail') || lineText.includes('error') || lineText.includes('timeout')) {
                            summaryData.failed++;
                        } else if (lineText.includes('no-info') || lineText.includes('no info') || 
                                   (!ipAddress || ipAddress === 'N/A' || !macAddress || macAddress === 'N/A')) {
                            summaryData.noInfo++;
                        } else if (lineText.includes('reated') || lineText.includes('partial') || lineText.includes('warning')) {
                            summaryData.warning++;
                        } else if (uptime && uptime.includes('up-') && ipAddress && macAddress && 
                                   ipAddress !== 'N/A' && macAddress !== 'N/A') {
                            summaryData.successful++;
                        } else {
                            summaryData.warning++;
                        }
                    });
                    
                } else if (dataType === 'lldp') {
                    // Parse lldp_results.ini directly (structured text format)
                    const response = await fetch('lldp_results.ini');
                    const text = await response.text();
                    const lines = text.split('\n');
                    
                    summaryData.totalConnections = 0;
                    summaryData.successful = 0;
                    summaryData.failed = 0;
                    summaryData.warning = 0;
                    summaryData.noInfo = 0;
                    
                    lines.forEach(line => {
                        // Look for port status lines (swp + Pass/Fail/No-Info pattern)
                        if (line.includes('swp') && (line.includes('Pass') || line.includes('Fail') || line.includes('No-Info'))) {
                            const parts = line.trim().split(/\s+/);
                            if (parts.length >= 2) {
                                const status = parts[1]; // Status is second column
                                summaryData.totalConnections++;
                                
                                if (status === 'Pass') summaryData.successful++;
                                else if (status === 'Fail') summaryData.failed++;
                                else if (status === 'No-Info') summaryData.noInfo++;
                            }
                        }
                    });
                    
                    // LLDP data parsed
                    
                } else if (dataType === 'optical') {
                    // Special case for optical: use summary cards because they have correct total ports count
                    const response = await fetch('monitor-results/optical-analysis.html');
                    
                    if (!response.ok) {
                        return summaryData;
                    }
                    
                    const html = await response.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Parse summary cards for optical (they have the correct total ports count)
                    const totalPortsElement = doc.querySelector('#total-ports');
                    const excellentElement = doc.querySelector('#excellent-ports');
                    const goodElement = doc.querySelector('#good-ports');
                    const warningElement = doc.querySelector('#warning-ports');
                    const criticalElement = doc.querySelector('#critical-ports');
                    
                    summaryData.totalPorts = totalPortsElement ? parseInt(totalPortsElement.textContent) : 0;
                    summaryData.excellent = excellentElement ? parseInt(excellentElement.textContent) : 0;
                    summaryData.good = goodElement ? parseInt(goodElement.textContent) : 0;
                    summaryData.warning = warningElement ? parseInt(warningElement.textContent) : 0;
                    summaryData.critical = criticalElement ? parseInt(criticalElement.textContent) : 0;
                    
                    // Count unique devices from table for optical (if needed)
                    const rows = doc.querySelectorAll('tbody tr[data-health]');
                    summaryData.totalDevices = new Set(Array.from(rows).map(row => row.cells[0]?.textContent.trim())).size;
                    
                } else if (dataType === 'hardware') {
                    // Parse hardware-analysis.html summary cards
                    const response = await fetch('monitor-results/hardware-analysis.html');
                    
                    if (!response.ok) {
                        return summaryData;
                    }
                    
                    const html = await response.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Parse summary cards for hardware
                    const totalDevicesElement = doc.querySelector('#total-devices');
                    const excellentElement = doc.querySelector('#excellent-devices');
                    const goodElement = doc.querySelector('#good-devices');
                    const warningElement = doc.querySelector('#warning-devices');
                    const criticalElement = doc.querySelector('#critical-devices');
                    
                    summaryData.totalDevices = totalDevicesElement ? parseInt(totalDevicesElement.textContent) : 0;
                    summaryData.excellent = excellentElement ? parseInt(excellentElement.textContent) : 0;
                    summaryData.good = goodElement ? parseInt(goodElement.textContent) : 0;
                    summaryData.warning = warningElement ? parseInt(warningElement.textContent) : 0;
                    summaryData.critical = criticalElement ? parseInt(criticalElement.textContent) : 0;
                    
                } else if (dataType === 'log') {
                    // Parse log summary data from log_summary.json
                    try {
                        const response = await fetch('monitor-results/log_summary.json');
                        
                        if (!response.ok) {
                            // Return default values if log summary doesn't exist yet
                            return {
                                totalDevices: 0,
                                critical: 0,
                                warning: 0,
                                error: 0,
                                info: 0
                            };
                        }
                        
                        const logSummaryData = await response.json();
                        
                        summaryData.totalDevices = logSummaryData.total_devices || 0;
                        summaryData.critical = logSummaryData.totals?.critical || 0;
                        summaryData.warning = logSummaryData.totals?.warning || 0;
                        summaryData.error = logSummaryData.totals?.error || 0;
                        summaryData.info = logSummaryData.totals?.info || 0;
                        
                    } catch (error) {
                        console.warn('Failed to fetch log summary data:', error);
                        // Return default values
                        summaryData = {
                            totalDevices: 0,
                            critical: 0,
                            warning: 0,
                            error: 0,
                            info: 0
                        };
                    }
                    
                } else {
                    // For other analysis pages (BGP, BER, Link Flap), parse table data
                    const pageMap = {
                        'bgp': 'monitor-results/bgp-analysis.html',
                        'ber': 'monitor-results/ber-analysis.html',
                        'flap': 'monitor-results/link-flap-analysis.html'
                    };
                    
                    const pageUrl = pageMap[dataType];
                    if (pageUrl) {
                        const response = await fetch(pageUrl);
                        
                        if (!response.ok) {
                            return summaryData;
                        }
                        
                        const html = await response.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        
                        // Parse table rows instead of summary cards
                        const rows = doc.querySelectorAll('tbody tr[data-health], tbody tr[data-status], tbody tr[data-state]');
                        
                        summaryData.totalPorts = rows.length;
                        summaryData.totalDevices = new Set(Array.from(rows).map(row => row.cells[0]?.textContent.trim())).size;
                        summaryData.totalNeighbors = rows.length; // BGP neighbors = rows
                        summaryData.excellent = 0;
                        summaryData.good = 0;
                        summaryData.warning = 0;
                        summaryData.critical = 0;
                        summaryData.established = 0;
                        summaryData.failed = 0;
                        summaryData.stable = 0;
                        summaryData.problematic = 0;
                        
                        rows.forEach(row => {
                            const health = row.getAttribute('data-health') || '';
                            const status = row.getAttribute('data-status') || '';
                            const state = row.getAttribute('data-state') || '';
                            
                            // Count by health/status
                            if (health === 'excellent' || status === 'excellent') summaryData.excellent++;
                            else if (health === 'good' || status === 'good') summaryData.good++;
                            else if (health === 'warning' || status === 'warning') summaryData.warning++;
                            else if (health === 'critical' || status === 'critical') summaryData.critical++;
                            
                            // Count by state (BGP)
                            if (state === 'established') summaryData.established++;
                            else if (state === 'idle' || state === 'active' || state === 'connect' || state === 'down') summaryData.failed++;
                            
                            // Count by stability (Link Flap uses 'ok' not 'stable')
                            if (status === 'stable' || status === 'ok') summaryData.stable++;
                            else if (status === 'problematic' || status === 'flapped') summaryData.problematic++;
                        });
                        
                        // Calculate percentages based on data type
                        if (dataType === 'bgp' && summaryData.totalNeighbors > 0) {
                            summaryData.healthPercent = ((summaryData.established / summaryData.totalNeighbors) * 100).toFixed(1);
                        }
                        
                        if (dataType === 'flap' && summaryData.totalPorts > 0) {
                            summaryData.stabilityPercent = ((summaryData.stable / summaryData.totalPorts) * 100).toFixed(1);
                        }
                        
                        // Analysis data parsed from table
                    }
                }
                
                return summaryData;
                
            } catch (error) {
                console.warn(`Failed to fetch ${dataType} data:`, error);
                return {};
            }
        }

        // Calculate overall network stats with real-time data
        async function updateNetworkStats() {
            try {
                // Fetch data directly from raw data files
                const [assetsData, lldpData, bgpData, opticalData, berData, flapData, hardwareData, logData] = await Promise.all([
                    fetchRawDataSummary('assets'),
                    fetchRawDataSummary('lldp'), 
                    fetchRawDataSummary('bgp'),
                    fetchRawDataSummary('optical'),
                    fetchRawDataSummary('ber'),
                    fetchRawDataSummary('flap'),
                    fetchRawDataSummary('hardware'),
                    fetchRawDataSummary('log')
                ]);
                
                // Data fetched successfully

                // Update dashboard summary cards
                updateDashboardCard('assets-total', assetsData.totalDevices);
                updateDashboardCard('assets-success', assetsData.successful);
                updateDashboardCard('assets-warning', assetsData.warning);
                updateDashboardCard('assets-failed', assetsData.failed);
                updateDashboardCard('assets-no-info', assetsData.noInfo);

                updateDashboardCard('lldp-total', lldpData.totalConnections);
                updateDashboardCard('lldp-success', lldpData.successful);
                updateDashboardCard('lldp-failed', lldpData.failed);
                updateDashboardCard('lldp-warning', lldpData.warning);
                updateDashboardCard('lldp-no-info', lldpData.noInfo);

                updateDashboardCard('bgp-devices', bgpData.totalDevices);
                updateDashboardCard('bgp-neighbors', bgpData.totalNeighbors);
                updateDashboardCard('bgp-established', bgpData.established);
                updateDashboardCard('bgp-down', bgpData.failed);
                updateDashboardCard('bgp-health', bgpData.healthPercent ? bgpData.healthPercent + '%' : '0.0%');

                updateDashboardCard('optical-total', opticalData.totalPorts);
                updateDashboardCard('optical-excellent', opticalData.excellent);
                updateDashboardCard('optical-good', opticalData.good);
                updateDashboardCard('optical-warning', opticalData.warning);
                updateDashboardCard('optical-critical', opticalData.critical);

                updateDashboardCard('ber-total', berData.totalPorts);
                updateDashboardCard('ber-excellent', berData.excellent);
                updateDashboardCard('ber-good', berData.good);
                updateDashboardCard('ber-warning', berData.warning);
                updateDashboardCard('ber-critical', berData.critical);

                updateDashboardCard('flap-devices', flapData.totalDevices);
                updateDashboardCard('flap-ports', flapData.totalPorts);
                updateDashboardCard('flap-stable', flapData.stable);
                updateDashboardCard('flap-problematic', flapData.problematic);
                updateDashboardCard('flap-stability', flapData.stabilityPercent ? flapData.stabilityPercent + '%' : '0.0%');

                updateDashboardCard('hardware-total', hardwareData.totalDevices);
                updateDashboardCard('hardware-excellent', hardwareData.excellent);
                updateDashboardCard('hardware-good', hardwareData.good);
                updateDashboardCard('hardware-warnings', hardwareData.warning);
                updateDashboardCard('hardware-critical', hardwareData.critical);

                updateDashboardCard('log-devices', logData.totalDevices);
                updateDashboardCard('log-critical', logData.critical);
                updateDashboardCard('log-warnings', logData.warning);
                updateDashboardCard('log-errors', logData.error);
                updateDashboardCard('log-info', logData.info);

                // Calculate overall network statistics
                const totalDevices = assetsData.totalDevices || 0;
                const totalInterfaces = Math.max(opticalData.totalPorts || 0, berData.totalPorts || 0);
                
            // Calculate critical issues with breakdown for tooltip
            const criticalBreakdown = {
                'Assets Failed': assetsData.failed || 0,
                'LLDP Failed Links': lldpData.failed || 0,
                'LLDP No Info': lldpData.noInfo || 0,
                'BGP Failed': bgpData.failed || 0,
                'Optical Critical': opticalData.critical || 0,
                'BER Critical': berData.critical || 0,
                'Link Flaps': flapData.problematic || 0,
                'Hardware Critical': hardwareData.critical || 0,
                'Hardware Warning': hardwareData.warning || 0,
                'Log Critical': logData.critical || 0,
                'Log Warning': logData.warning || 0
            };
            
            const criticalIssues = Object.values(criticalBreakdown).reduce((a, b) => a + b, 0);
            
            // Build tooltip HTML
            let tooltipHtml = '<div class="tooltip-title">Critical Issues Breakdown</div>';
            for (const [source, count] of Object.entries(criticalBreakdown)) {
                const hasIssues = count > 0 ? 'has-issues' : '';
                tooltipHtml += `<div class="tooltip-row ${hasIssues}"><span class="source">${source}</span><span class="count">${count}</span></div>`;
            }
            document.getElementById('critical-tooltip').innerHTML = tooltipHtml;
                
                const healthyItems = 
                    (assetsData.successful || 0) +
                    (lldpData.successful || 0) +
                    (opticalData.excellent || 0) +
                    (flapData.stable || 0) +
                    (hardwareData.excellent || 0) +
                    (hardwareData.good || 0) +
                    (logData.info || 0);
                
                const totalAssessments = 
                    totalDevices + 
                    (lldpData.totalConnections || 0) + 
                    (opticalData.totalPorts || 0) + 
                    (flapData.totalPorts || 0) +
                    (hardwareData.totalDevices || 0) +
                    ((logData.critical || 0) + (logData.warning || 0) + (logData.info || 0));
                
            const overallHealth = totalAssessments > 0 ? Math.round((healthyItems / totalAssessments) * 100) : 0;
            
            // Update dashboard stats
            document.getElementById('total-network-devices').textContent = totalDevices;
            document.getElementById('total-interfaces').textContent = totalInterfaces;
            document.getElementById('overall-health').textContent = overallHealth + '%';
            document.getElementById('critical-issues').textContent = criticalIssues;
            
            // Color code the health percentage
            const healthElement = document.getElementById('overall-health');
            if (overallHealth >= 95) {
                healthElement.style.color = '#4caf50';
            } else if (overallHealth >= 85) {
                healthElement.style.color = '#8bc34a';
            } else if (overallHealth >= 70) {
                healthElement.style.color = '#ff9800';
            } else {
                healthElement.style.color = '#f44336';
            }
            
            // Color code critical issues
            const criticalElement = document.getElementById('critical-issues');
            if (criticalIssues === 0) {
                criticalElement.style.color = '#4caf50';
            } else if (criticalIssues <= 5) {
                criticalElement.style.color = '#ff9800';
            } else {
                criticalElement.style.color = '#f44336';
                }
                
            } catch (error) {
                console.error('Failed to update network stats:', error);
            }
        }

        // Helper function to update dashboard card values
        function updateDashboardCard(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = value !== undefined && value !== null ? value : 0;
            }
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            setLastUpdated();
            updateNetworkStats();
            
            // Update every 2 minutes (large data files)
            setInterval(function() {
                setLastUpdated();
                updateNetworkStats();
            }, 120000);
        });

        // Add hover effects for clickable cards
        document.querySelectorAll('.summary-card[onclick]').forEach(card => {
            card.style.cursor = 'pointer';
        });
    </script>
</body>
</html>